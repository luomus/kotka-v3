<ng-container *ngIf="vm$ | async as vm else spinner">
  <kui-main-content
    class="mb-5"
    [containerClass]="'container'"
    [header]="(visibleDataTypeName | titlecase) + (vm.routeParams.dataURI ? (' ' + vm.routeParams.dataURI) : '')"
  >
    <ngb-alert *ngIf="isErrorViewModel(vm)" [type]="'danger'" [dismissible]="false">
      <ng-container *ngIf="vm.errorType === versionHistoryErrorEnum.dataNotFound else genericError">
        {{ visibleDataTypeName | titlecase }} <ng-container *ngIf="vm.routeParams.dataURI">with URI {{ vm.routeParams.dataURI }} </ng-container>was not found.
      </ng-container>
      <ng-template #genericError>
        An unexpected error occurred
      </ng-template>
    </ngb-alert>

    <ng-container *ngIf="isSuccessViewModel(vm)">
      <kotka-version-list
        *ngIf="isVersionListViewModel(vm)"
        [data]="vm.versionList"
        (compareVersionsClick)="onCompareVersionsClick($event)"
      ></kotka-version-list>
      <kotka-version
        *ngIf="isVersionViewModel(vm)"
        [visibleDataTypeName]="visibleDataTypeName"
        [version]="vm.routeParams.version"
        [versionList]="vm.versionList"
        [form]="vm.form"
        [data]="vm.data"
      ></kotka-version>
      <kotka-version-comparison
        *ngIf="isVersionComparisonViewModel(vm)"
        [form]="vm.form"
        [data]="vm.diffData"
      ></kotka-version-comparison>
    </ng-container>
  </kui-main-content>
</ng-container>

<ng-template #spinner>
  <kui-spinner></kui-spinner>
</ng-template>
